{"version":3,"sources":["../../src/core/common/Stick.js"],"names":["Stick","props","state","top","left","width","measure","node","renderNode","container","unmountNode","className","children","style","element","ref","createContainer","track","styleNode","unstable_renderSubtreeIntoContainer","createElement","cancelAnimationFrame","animationId","unmountComponentAtNode","document","body","removeChild","requestAnimationFrame","newStyle","calculateStyle","position","setState","defaultProps","zIndex","appendChild","topLeft","topRight","topCenter","bottomCenter","bottomRight","middleRight","middleCenter","middleLeft","bottomLeft","getBoundingClientRect","scrollX","scrollY","right","bottom","height","hasPageOffset","window","pageXOffset","undefined","isCSS1Compat","hasCompatMode","compatMode","pageYOffset","documentElement","scrollTop","hasScrollTop","scrollLeft","hasScrollLeft"],"mappings":"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","file":"Stick.js","sourcesContent":["import React, {PureComponent} from 'react'\nimport ReactDOM from 'react-dom'\n\nexport default class Stick extends PureComponent {\n\n    static defaultProps = {\n        position: 'bottom left',\n        styleNode: {\n            position: 'absolute',\n            zIndex: 10000\n        }\n    }\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            top: 0,\n            left: 0,\n            width: 0\n        }\n    }\n\n    componentDidMount() {\n        this.measure()\n    }\n\n    componentDidUpdate() {\n        this.measure()\n        if (this.props.node) {\n            this.renderNode()\n        }\n\n        if (!this.props.node && this.container) {\n            this.unmountNode()\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.container) {\n            this.unmountNode()\n        }\n    }\n\n    render() {\n        const { className, children, style } = this.props\n        return (\n            <div className={className} style={style} ref={ref => this.element = ref}>\n                {children}\n            </div>\n        )\n    }\n\n    renderNode() {\n        if (!this.container) {\n            this.container = createContainer()\n            this.track()\n        }\n\n        const { styleNode, node } = this.props\n\n        const className = 'stick-pointer'\n        const style = {\n            ...(styleNode || {}),\n            ...this.state\n        }\n\n        ReactDOM.unstable_renderSubtreeIntoContainer(\n            this,\n            React.createElement('div', {className, style}, node),\n            this.container\n        )\n    }\n\n    unmountNode() {\n        cancelAnimationFrame(this.animationId)\n        ReactDOM.unmountComponentAtNode(this.container)\n        document.body.removeChild(this.container)\n        delete this.container\n    }\n\n    track() {\n        this.animationId = requestAnimationFrame(() => this.track())\n        this.measure()\n    }\n\n    measure() {\n        const newStyle = calculateStyle(this.props.position, this.element)\n        this.setState(newStyle)\n    }\n\n}\n\nfunction createContainer() {\n    const container = document.createElement('div')\n    document.body.appendChild(container)\n    return container\n}\n\nfunction calculateStyle(position, element) {\n    switch (position) {\n        case 'top left':\n            return topLeft(element)\n        case 'top right':\n            return topRight(element)\n        case 'top center':\n            return topCenter(element)\n        case 'bottom center':\n            return bottomCenter(element)\n        case 'bottom right':\n            return bottomRight(element)\n        case 'middle right':\n            return middleRight(element)\n        case 'middle center':\n            return middleCenter(element)\n        case 'middle left':\n            return middleLeft(element)\n        case 'bottom left':\n        default:\n            return bottomLeft(element)\n    }\n}\n\nfunction topLeft(element) {\n    const { width, left, top } = element.getBoundingClientRect()\n    return {\n        width,\n        left: left + scrollX(),\n        top: top + scrollY()\n    }\n}\n\nfunction topRight(element) {\n    const { width, right, top } = element.getBoundingClientRect()\n    return {\n        width,\n        left: right + scrollX(),\n        top: top + scrollY()\n    }\n}\n\nfunction topCenter(element) {\n    const { width, left, top } = element.getBoundingClientRect()\n    return {\n        width,\n        left: left + scrollX() + (width /2),\n        top : top + scrollY()\n    }\n}\n\nfunction bottomLeft(element) {\n    const {width, left, bottom} = element.getBoundingClientRect()\n    return {\n        width,\n        left: left + scrollX(),\n        top: bottom + scrollY()\n    }\n}\n\nfunction bottomRight(element) {\n    const {width, right, bottom} = element.getBoundingClientRect()\n    return {\n        width,\n        left: right + scrollX(),\n        top: bottom + scrollY()\n    }\n}\n\nfunction bottomCenter(element) {\n    const {width, left, bottom} = element.getBoundingClientRect()\n    return {\n        width,\n        left: left + scrollX() + (width / 2),\n        top: bottom + scrollY()\n    }\n}\n\nfunction middleRight(element) {\n    const {width, height, right, top} = element.getBoundingClientRect()\n    return {\n        width,\n        left: right + scrollX(),\n        top: top + scrollY() + (height / 2)\n    }\n}\n\nfunction middleCenter(element) {\n    const {width, height, left, top} = element.getBoundingClientRect()\n    return {\n        width,\n        left: left + scrollX() + (width / 2),\n        top: top + scrollY() + (height / 2)\n    }\n}\n\nfunction middleLeft(element) {\n    const {width, height, left, top} = element.getBoundingClientRect()\n    return {\n        width,\n        left: left + scrollX(),\n        top: top + scrollY() + (height / 2)\n    }\n}\n\n\n\n//https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollY#Notes\nfunction hasPageOffset() {\n    return (\n        typeof window !== 'undefined' &&\n        typeof window.pageXOffset !== undefined\n    )\n}\n\nfunction isCSS1Compat() {\n    const hasCompatMode = (\n        typeof document !== 'undefined' &&\n        typeof document.compatMode === 'string'\n    )\n    const compatMode = hasCompatMode ? document.compatMode : ''\n    return compatMode === 'CSS1Compat'\n}\n\nfunction scrollY() {\n    if (typeof window !== 'undefined' && typeof window.scrollY === 'number') {\n        return window.scrollY\n    }\n\n    if (hasPageOffset() === true) {\n        return window.pageYOffset\n    }\n\n    if (isCSS1Compat() === true) {\n        return document.documentElement.scrollTop\n    }\n\n    const hasScrollTop = (\n        typeof document !== 'undefined' &&\n        typeof document.body !== 'undefined' &&\n        typeof document.body.scrollTop === 'number'\n    )\n\n    return hasScrollTop ? document.body.scrollTop : 0\n}\n\nfunction scrollX() {\n    if (typeof window !== 'undefined' && typeof window.scrollX === 'number') {\n        return window.scrollX\n    }\n\n    if (hasPageOffset === true) {\n        return window.pageXOffset\n    }\n\n    if (isCSS1Compat === true) {\n        return document.documentElement.scrollLeft\n    }\n\n    const hasScrollLeft = (\n        typeof document !== 'undefined' &&\n        typeof document.body !== 'undefined' &&\n        typeof document.body.scrollLeft === 'number'\n    )\n\n    return hasScrollLeft ? document.body.scrollLeft : 0\n}\n"]}